function [FM, JTheta] = fast_jac_substitution(vars, F, params)
%% State vector syms.
rx = vars(1,1); ry = vars(2,1); rz = vars(3,1);
vx = vars(4,1); vy = vars(5,1); vz = vars(6,1);
qbx = vars(7,1); qby = vars(8,1); qbz = vars(9,1); qbw = vars(10,1);
wx = vars(11,1); wy = vars(12,1); wz = vars(13,1);
eqx = vars(14, 1); eqy = vars(15, 1); eqz = vars(16, 1);

%n1  = vars(14,1); n2 = vars(15,1); n3 = vars(16,1); n4 = vars(17,1);

%% Parameter syms.
c_T = params(1,1); c_m = params(2,1);
jxx =  params(3,1); jyy = params(4,1); jzz = params(5,1);
r_offx = params(6,1); r_offy = params(7,1); r_offz = params(8,1);

%% Control input syms.
%u1 = vars(27,1); u2 = vars(28,1); u3 = vars(29,1); u4 = vars(30,1);

%% Constant syms.
g = params(9,1); m = params(10,1); F1 = F(1, 1); F2 = F(2, 1); F3 = F(3, 1); F4 = F(4, 1);
dt = params(11, 1);

% m11 = -1; m12 = -1; m13 = -1; m14 = -1;
% m21 = -0.15839*sin(0.7854); m22 = 0.15839*sin(0.7854); m23 =0.15839*sin(0.7854); m24 =-0.15839*sin(0.7854);
% m31 =0.15839*cos(0.7854); m32 = -0.15839*cos(0.7854); m33 = 0.15839*cos(0.7854); m34 =-0.15839*cos(0.7854);
% m41 =0.011651904893177; m42 =0.011651904893177; m43 =-0.011651904893177; m44 =-0.011651904893177;

decide = norm(dt.*[wx; wy; wz]);

% if decide >= 0 && decide < 1e-4
FM = [ 1, 0, 0, dt*(2*qbw^2 + 2*qbx*conj(qbx) - 1),  -dt*(2*qbw*qbz - 2*qbx*conj(qby)),   dt*(2*qbw*qby + 2*qbx*conj(qbz)),   0,   0,   0,                                  0,                                  0,                                  0;
 0, 1, 0,   dt*(2*qbw*qbz + 2*qby*conj(qbx)), dt*(2*qbw^2 + 2*qby*conj(qby) - 1),  -dt*(2*qbw*qbx - 2*qby*conj(qbz)),   0,   0,   0,                                  0,                                  0,                                  0;
 0, 0, 1,  -dt*(2*qbw*qby - 2*qbz*conj(qbx)),   dt*(2*qbw*qbx + 2*qbz*conj(qby)), dt*(2*qbw^2 + 2*qbz*conj(qbz) - 1),   0,   0,   0,                                  0,                                  0,                                  0;
 0, 0, 0,                                  1,                              dt*wz,                             -dt*wy,   0,   0,   0,        -dt*(r_offy*wy + r_offz*wz), -dt*(vz + r_offy*wx - 2*r_offx*wy),  dt*(vy - r_offz*wx + 2*r_offx*wz);
 0, 0, 0,                             -dt*wz,                                  1,                              dt*wx,   0,   0,   0,  dt*(vz + 2*r_offy*wx - r_offx*wy),        -dt*(r_offx*wx + r_offz*wz), -dt*(vx + r_offz*wy - 2*r_offy*wz);
 0, 0, 0,                              dt*wy,                             -dt*wx,                                  1,   0,   0,   0, -dt*(vy - 2*r_offz*wx + r_offx*wz),  dt*(vx + 2*r_offz*wy - r_offy*wz),        -dt*(r_offx*wx + r_offy*wy);
 0, 0, 0,                                  0,                                  0,                                  0,   0,  wz, -wy,                                  0,                               -eqz,                                eqy;
 0, 0, 0,                                  0,                                  0,                                  0, -wz,   0,  wx,                                eqz,                                  0,                               -eqx;
 0, 0, 0,                                  0,                                  0,                                  0,  wy, -wx,   0,                               -eqy,                                eqx,                                  0;
 0, 0, 0,                                  0,                                  0,                                  0,   0,   0,   0,                                  1,         (dt*(jyy*wz - jzz*wz))/jxx,         (dt*(jyy*wy - jzz*wy))/jxx;
 0, 0, 0,                                  0,                                  0,                                  0,   0,   0,   0,        -(dt*(jxx*wz - jzz*wz))/jyy,                                  1,        -(dt*(jxx*wx - jzz*wx))/jyy;
 0, 0, 0,                                  0,                                  0,                                  0,   0,   0,   0,         (dt*(jxx*wy - jyy*wy))/jzz,         (dt*(jxx*wx - jyy*wx))/jzz,                                  1];

% else
% FM = [ 1, 0, 0, dt*(2*qbw^2 + 2*qbx*conj(qbx) - 1),  -dt*(2*qbw*qbz - 2*qbx*conj(qby)),   dt*(2*qbw*qby + 2*qbx*conj(qbz)),                                                      dt*(2*qbx*vx + 2*vx*conj(qbx) + 2*vy*conj(qby) + 2*vz*conj(qbz)),                                                                                              dt*(2*qbx*vy + 2*qbw*vz),                                                                                             -dt*(2*qbw*vy - 2*qbx*vz),                                                                                  dt*(4*qbw*vx - 2*qbz*vy + 2*qby*vz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
%  0, 1, 0,   dt*(2*qbw*qbz + 2*qby*conj(qbx)), dt*(2*qbw^2 + 2*qby*conj(qby) - 1),  -dt*(2*qbw*qbx - 2*qby*conj(qbz)),                                                                                              dt*(2*qby*vx - 2*qbw*vz),                                                      dt*(2*qby*vy + 2*vx*conj(qbx) + 2*vy*conj(qby) + 2*vz*conj(qbz)),                                                                                              dt*(2*qbw*vx + 2*qby*vz),                                                                                  dt*(2*qbz*vx + 4*qbw*vy - 2*qbx*vz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
%  0, 0, 1,  -dt*(2*qbw*qby - 2*qbz*conj(qbx)),   dt*(2*qbw*qbx + 2*qbz*conj(qby)), dt*(2*qbw^2 + 2*qbz*conj(qbz) - 1),                                                                                              dt*(2*qbz*vx + 2*qbw*vy),                                                                                             -dt*(2*qbw*vx - 2*qbz*vy),                                                      dt*(2*qbz*vz + 2*vx*conj(qbx) + 2*vy*conj(qby) + 2*vz*conj(qbz)),                                                                                  dt*(2*qbx*vy - 2*qby*vx + 4*qbw*vz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
%  0, 0, 0,                                  1,                              dt*wz,                             -dt*wy,                                                                                                     -2*dt*g*conj(qbz),                                                                                                      2*dt*g*conj(qbw),                                                                                                           -2*dt*g*qbx,                                                                                                     2*dt*g*conj(qby),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -dt*(r_offy*wy + r_offz*wz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -dt*(vz + r_offy*wx - 2*r_offx*wy),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        dt*(vy - r_offz*wx + 2*r_offx*wz);
%  0, 0, 0,                             -dt*wz,                                  1,                              dt*wx,                                                                                                     -2*dt*g*conj(qbw),                                                                                                     -2*dt*g*conj(qbz),                                                                                                           -2*dt*g*qby,                                                                                                    -2*dt*g*conj(qbx),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        dt*(vz + 2*r_offy*wx - r_offx*wy),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -dt*(r_offx*wx + r_offz*wz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -dt*(vx + r_offz*wy - 2*r_offy*wz);
%  0, 0, 0,                              dt*wy,                             -dt*wx,                                  1,                                                                                                                     0,                                                                                                                     0,                                                                                           -dt*g*(2*qbz + 2*conj(qbz)),                                                                                                    -4*dt*g*conj(qbw),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -dt*(vy - 2*r_offz*wx + r_offx*wz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        dt*(vx + 2*r_offz*wy - r_offy*wz),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -dt*(r_offx*wx + r_offy*wy);
%  0, 0, 0,                                  0,                                  0,                                  0,                                                             cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2),  (dt*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), -(dt*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), (dt*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                           (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qbx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) + (dt^2*qbw*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbz*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbw*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbz*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qby*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt^2*qbw*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*qbx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt*qbz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt^2*qbz*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbw*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbz*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qby*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt*qby*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qbx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) + (dt^2*qbw*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbz*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbw*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbz*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qby*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2);
%  0, 0, 0,                                  0,                                  0,                                  0, -(dt*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                                             cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2),  (dt*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), (dt*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                           (dt*qbz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qby*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) + (dt^2*qbz*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbw*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbx*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbz*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbx*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qby*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) + (dt^2*qbz*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbw*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbx*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbz*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbx*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt^2*qbz*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*qby*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt*qbx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) + (dt^2*qbw*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbx*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*qbz*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*qbx*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2);
%  0, 0, 0,                                  0,                                  0,                                  0,  (dt*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), -(dt*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                                             cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2), (dt*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                           (dt^2*qbx*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*qbz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*qby*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*qby*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) + (dt^2*qbw*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbx*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt*qbx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qbz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*qby*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbx*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbw*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbx*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2),                                           (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) - (dt*qbz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*qby*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbx*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qbw*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) + (dt^2*qby*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbx*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt^2*qbw*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2);
%  0, 0, 0,                                  0,                                  0,                                  0, -(dt*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), -(dt*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2), -(dt*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2),                                                            cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2), (dt^2*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qbx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qbx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qby))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qbz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*conj(qbx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) + (dt^2*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qby))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wx)*sign(dt*wx)*conj(qbz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2), (dt^2*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qbx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qbx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qby))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qbz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*conj(qby))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) + (dt^2*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qby))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wy)*sign(dt*wy)*conj(qbz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2), (dt^2*wx*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qbx))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) - (dt*qbw*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)) - (dt^2*wx*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qbx))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wy*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qby))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt^2*wz*cos((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qbz))/(2*(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)) - (dt*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*conj(qbz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2) + (dt^2*wy*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qby))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2) + (dt^2*wz*sin((abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(1/2)/2)*abs(dt*wz)*sign(dt*wz)*conj(qbz))/(abs(dt*wx)^2 + abs(dt*wy)^2 + abs(dt*wz)^2)^(3/2);
%  0, 0, 0,                                  0,                                  0,                                  0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dt*(jyy*wz - jzz*wz))/jxx,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dt*(jyy*wy - jzz*wy))/jxx;
%  0, 0, 0,                                  0,                                  0,                                  0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -(dt*(jxx*wz - jzz*wz))/jyy,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -(dt*(jxx*wx - jzz*wx))/jyy;
%  0, 0, 0,                                 0,                                  0,                                  0,                                                                                                                     0,                                                                                                                     0,                                                                                                                     0,                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dt*(jxx*wy - jyy*wy))/jzz,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dt*(jxx*wx - jyy*wx))/jzz,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1];
% end    
    
JTheta = [                              0;
                                        0;
                                        0;
                                        0;
                                        0;
                                        0;
                                        0;
                                        0;
                                        0;
                           (dt*wy*wz)/jxx;
 -(dt*(F3 - jxx*wx*wz + jzz*wx*wz))/jyy^2;
                          -(dt*wx*wy)/jzz];

% FI = [ 0, 0, 0, newqIB_x^2/4 - newqIB_y^2/4 - newqIB_z^2/4 + 1,                 (newqIB_x*newqIB_y)/2 - newqIB_z,                 newqIB_y + (newqIB_x*newqIB_z)/2, (newqIB_x*vB_B_x)/2 + (newqIB_y*vB_B_y)/2 + (newqIB_z*vB_B_z)/2,              vB_B_z + (newqIB_x*vB_B_y)/2 - (newqIB_y*vB_B_x)/2,              (newqIB_x*vB_B_z)/2 - vB_B_y - (newqIB_z*vB_B_x)/2;
%  0, 0, 0,               newqIB_z + (newqIB_x*newqIB_y)/2, - newqIB_x^2/4 + newqIB_y^2/4 - newqIB_z^2/4 + 1,                 (newqIB_y*newqIB_z)/2 - newqIB_x,              (newqIB_y*vB_B_x)/2 - (newqIB_x*vB_B_y)/2 - vB_B_z, (newqIB_x*vB_B_x)/2 + (newqIB_y*vB_B_y)/2 + (newqIB_z*vB_B_z)/2,              vB_B_x + (newqIB_y*vB_B_z)/2 - (newqIB_z*vB_B_y)/2;
%  0, 0, 0,               (newqIB_x*newqIB_z)/2 - newqIB_y,                 newqIB_x + (newqIB_y*newqIB_z)/2, - newqIB_x^2/4 - newqIB_y^2/4 + newqIB_z^2/4 + 1,              vB_B_y - (newqIB_x*vB_B_z)/2 + (newqIB_z*vB_B_x)/2,              (newqIB_z*vB_B_y)/2 - (newqIB_y*vB_B_z)/2 - vB_B_x, (newqIB_x*vB_B_x)/2 + (newqIB_y*vB_B_y)/2 + (newqIB_z*vB_B_z)/2;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                               0,                                                               0,                                                               0;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                               0,                                                               0,                                                               0;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                               0,                                                               0,                                                               0;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                               0,                                                     omega_z_IMU,                                                    -omega_y_IMU;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                    -omega_z_IMU,                                                               0,                                                     omega_x_IMU;
%  0, 0, 0,                                              0,                                                0,                                                0,                                                     omega_y_IMU,                                                    -omega_x_IMU,                                                               0];

% [ newqIB_x, newqIB_y, newqIB_z, omega_x_IMU, omega_y_IMU, omega_z_IMU, vB_B_x, vB_B_y, vB_B_z]
end
